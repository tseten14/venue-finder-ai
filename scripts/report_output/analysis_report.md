# Venue Finder AI — Transit Entrance Dataset Analysis

> Comprehensive analysis of transit station entrance data across 10 agencies worldwide, generated by `scripts/report_visualization.py` using numpy, pandas, matplotlib, and seaborn.

---

## 1. Dataset Overview

### 1.1 What This Data Represents

The Venue Finder AI project maintains a collection of transit station entrance datasets derived from GTFS (General Transit Feed Specification) feeds published by public transit agencies. Each record represents a single **physical entrance point** — a door, stairway, elevator, or accessibility ramp — at a transit station.

The data is stored as CSV files in `data/entrances/` and is consumed by three parts of the application:

1. **Frontend** — loaded via `fetch()` and rendered as interactive Leaflet map markers
2. **Backend** — loaded with pandas for fuzzy station name search via the FastAPI API
3. **Analysis scripts** — this report, which computes statistics and generates charts

### 1.2 Dataset Scale

The dataset contains **10 transit agency files** totalling **15,525 entrance records** across **2,355 unique station names**.

| Metric | Value |
|--------|------:|
| Transit agencies | 10 |
| Total entrance records | 15,525 |
| Unique station names | 2,355 |
| Cities covered | 8 |
| Countries | 3 (USA, France, UK) |
| Continents | 2 (North America, Europe) |

### 1.3 Data Schema

Each CSV row contains:

| Column | Type | Description |
|--------|------|-------------|
| `stationName` | string | Human-readable station name |
| `uniqueId` | string | Route, line, or stop identifier |
| `lat` | float | Latitude (WGS 84 decimal degrees) |
| `lon` | float | Longitude (WGS 84 decimal degrees) |

A single station typically has multiple rows — one per physical entrance.

---

## 2. Per-Agency Breakdown

### 2.1 Agency Statistics Table

| Agency | City | Records | Unique Stations | Entrances/Station | Lat Mean | Lon Mean | Geo Spread (σ) |
|--------|------|--------:|----------------:|------------------:|---------:|---------:|---------------:|
| Paris Métro | — | 11,111 | 1,193 | 9.3 | 48.8358 | 2.3469 | 0.2665 |
| MTA | — | 2,120 | 372 | 5.7 | 40.7285 | -73.9510 | 0.1002 |
| TfL | — | 513 | 221 | 2.3 | 51.5302 | -0.1652 | 0.1325 |
| CTA | — | 381 | 109 | 3.5 | 41.8907 | -87.6689 | 0.0801 |
| MBTA | — | 323 | 98 | 3.3 | 42.3392 | -71.0895 | 0.0940 |
| Metra | — | 247 | 90 | 2.7 | 41.8221 | -87.6872 | 0.1390 |
| WMATA | — | 239 | 98 | 2.4 | 38.9183 | -77.0881 | 0.1521 |
| SFMTA | — | 230 | 73 | 3.1 | 37.7488 | -122.2652 | 0.2955 |
| LA Metro | — | 229 | 101 | 2.3 | 34.0101 | -118.2804 | 0.1509 |
| BART | — | 132 | 50 | 2.6 | 37.7670 | -122.2623 | 0.2116 |

### 2.2 Agency Profiles

#### Paris Métro

- **11,111 entrance records** across **1,193 unique stations**
- Average of **9.3 entrances per station**
- Geographic center: (48.8358°N, 2.3469°E)
- Geographic spread: σ = 0.2665
- Latitude range: 47.9608° to 49.4264°
- Longitude range: 1.1497° to 3.5129°
- Station with most entrances: **Paris Saint-Lazare** (276 entrances)

#### MTA

- **2,120 entrance records** across **372 unique stations**
- Average of **5.7 entrances per station**
- Geographic center: (40.7285°N, -73.9510°E)
- Geographic spread: σ = 0.1002
- Latitude range: 40.5122° to 40.9036°
- Longitude range: -74.2529° to -73.7542°
- Station with most entrances: **Chambers St/WTC/Park Place/Cortlandt St** (35 entrances)

#### TfL

- **513 entrance records** across **221 unique stations**
- Average of **2.3 entrances per station**
- Geographic center: (51.5302°N, -0.1652°E)
- Geographic spread: σ = 0.1325
- Latitude range: 51.4020° to 51.7052°
- Longitude range: -0.6111° to 0.2359°
- Station with most entrances: **Charing Cross Underground Station** (14 entrances)

#### CTA

- **381 entrance records** across **109 unique stations**
- Average of **3.5 entrances per station**
- Geographic center: (41.8907°N, -87.6689°E)
- Geographic spread: σ = 0.0801
- Latitude range: 41.7216° to 42.0736°
- Longitude range: -87.9040° to -87.6058°
- Station with most entrances: **Jackson** (15 entrances)

#### MBTA

- **323 entrance records** across **98 unique stations**
- Average of **3.3 entrances per station**
- Geographic center: (42.3392°N, -71.0895°E)
- Geographic spread: σ = 0.0940
- Latitude range: 41.8679° to 42.4369°
- Longitude range: -71.3928° to -70.9898°
- Station with most entrances: **North Station** (12 entrances)

#### Metra

- **247 entrance records** across **90 unique stations**
- Average of **2.7 entrances per station**
- Geographic center: (41.8221°N, -87.6872°E)
- Geographic spread: σ = 0.1390
- Latitude range: 41.6454° to 42.0110°
- Longitude range: -87.8806° to -87.5424°
- Station with most entrances: **Edgebrook** (7 entrances)

#### WMATA

- **239 entrance records** across **98 unique stations**
- Average of **2.4 entrances per station**
- Geographic center: (38.9183°N, -77.0881°E)
- Geographic spread: σ = 0.1521
- Latitude range: 38.7667° to 39.1204°
- Longitude range: -77.4919° to -76.8450°
- Station with most entrances: **Herndon** (5 entrances)

#### SFMTA

- **230 entrance records** across **73 unique stations**
- Average of **3.1 entrances per station**
- Geographic center: (37.7488°N, -122.2652°E)
- Geographic spread: σ = 0.2955
- Latitude range: 37.2428° to 38.4391°
- Longitude range: -122.7146° to -121.7800°
- Station with most entrances: **Salesforce Transit Center** (11 entrances)

#### LA Metro

- **229 entrance records** across **101 unique stations**
- Average of **2.3 entrances per station**
- Geographic center: (34.0101°N, -118.2804°E)
- Geographic spread: σ = 0.1509
- Latitude range: 33.7680° to 34.1691°
- Longitude range: -118.4919° to -117.8909°
- Station with most entrances: **LAX / Metro Transit Center** (11 entrances)

#### BART

- **132 entrance records** across **50 unique stations**
- Average of **2.6 entrances per station**
- Geographic center: (37.7670°N, -122.2623°E)
- Geographic spread: σ = 0.2116
- Latitude range: 37.3682° to 38.0182°
- Longitude range: -122.4690° to -121.7800°
- Station with most entrances: **12th Street / Oakland City Center** (8 entrances)

---

## 3. Cross-Agency Relationships

### 3.1 System Size vs. Entrance Density

One of the most important questions is whether larger transit systems inherently have more entrances per station. The data shows that this is **not the case** — entrance density is driven primarily by urban form rather than system size.

- **Paris Métro** has the highest entrance density at **9.3 entrances per station**, despite also being the largest system by record count.
- **LA Metro** has the lowest density at **2.3 entrances per station**.
- The correlation between Total Entrances and Entrances/Station is **0.95**, which is strong but largely driven by Paris Métro's dominance in both metrics.

Factors that appear to drive entrance density include:

- **Underground depth** — deeper stations require more access points for pedestrian flow
- **Street grid density** — dense urban cores have entrances on multiple street corners
- **Accessibility regulations** — modern accessibility requirements mandate additional ramps and elevators
- **Transfer complexity** — junction stations connecting multiple lines have entrances for each line

### 3.2 Geographic Spread Analysis

Geographic spread measures how widely dispersed a transit network's stations are, computed as the combined standard deviation of latitude and longitude coordinates (σ = √(σ_lat² + σ_lon²)).

| Rank | Agency | Geo Spread (σ) | Interpretation |
|-----:|--------|---------------:|----------------|
| 1 | SFMTA | 0.2955 | Wide regional network |
| 2 | Paris Métro | 0.2665 | Wide regional network |
| 3 | BART | 0.2116 | Wide regional network |
| 4 | WMATA | 0.1521 | Medium-range urban network |
| 5 | LA Metro | 0.1509 | Medium-range urban network |
| 6 | Metra | 0.1390 | Medium-range urban network |
| 7 | TfL | 0.1325 | Medium-range urban network |
| 8 | MTA | 0.1002 | Compact urban core |
| 9 | MBTA | 0.0940 | Compact urban core |
| 10 | CTA | 0.0801 | Compact urban core |

**SFMTA** covers the widest geographic area (σ = 0.2955), reflecting a sprawling regional network that includes both urban and suburban stops. In contrast, **CTA** has the tightest cluster (σ = 0.0801), consistent with a compact, densely-served urban core.

Notably, geographic spread does **not** correlate strongly with system size (correlation: 0.44). Small systems like BART cover wide suburban areas, while the massive Paris Métro is relatively compact given its size.

### 3.3 Continental Clustering

The latitude and longitude box plots (charts 05 and 06) reveal two distinct continental clusters with no geographic overlap:

**North American systems** (8 agencies):

| Region | Agencies | Latitude Range | Longitude Range |
|--------|----------|----------------|-----------------|
| West Coast | BART, SFMTA, LA Metro | 33.8°–38.4°N | 122.7°–117.9°W |
| Midwest | CTA, Metra | 41.6°–42.1°N | 87.9°–87.5°W |
| East Coast | MTA, MBTA, WMATA | 38.8°–42.4°N | 77.5°–71.0°W |

**European systems** (2 agencies):

| Region | Agencies | Latitude Range | Longitude Range |
|--------|----------|----------------|-----------------|
| Western Europe | Paris Métro, TfL | 48.0°–51.7°N | 0.6°W–3.5°E |

This geographic separation means the agencies share **no overlapping station footprints**, making cross-system comparison purely structural (comparing network topology and entrance density rather than shared geography).

### 3.4 Correlation Matrix Analysis

The heatmap (chart 08) reveals the following relationships between agency-level metrics:

| Metric Pair | Correlation | Interpretation |
|-------------|------------:|----------------|
| Total Entrances ↔ Unique Stations | 0.99 | Very strong — bigger systems have both more stations and more entrances |
| Total Entrances ↔ Entrances/Station | 0.95 | Strong — but heavily influenced by Paris Métro |
| Total Entrances ↔ Geo Spread | 0.44 | Moderate — system size weakly predicts geographic extent |
| Unique Stations ↔ Geo Spread | 0.38 | Weak — more stations doesn't mean wider coverage |
| Lat Std ↔ Lon Std | 0.68 | Moderate — networks that spread north-south also tend to spread east-west |
| Entrances/Station ↔ Geo Spread | 0.33 | Weak — density is independent of geographic extent |

**Key insight**: Entrance density (entrances per station) is the most independent metric — it has weak correlations with both system size and geographic spread, confirming that it is driven by local urban factors rather than network-level characteristics.

### 3.5 Entrance-Per-Station Distribution

Across all agencies and stations, the distribution of entrances per station is **right-skewed** (positively skewed):

| Statistic | Value |
|-----------|------:|
| Minimum | 1 |
| 25th percentile | 2 |
| Median (50th) | 4 |
| 75th percentile | 6 |
| 90th percentile | 12 |
| 95th percentile | 20 |
| Maximum | 276 |
| Mean | 6.5 |
| Std Dev | 12.8 |

Most stations (the majority) have between 1 and 5 entrances. However, major hub stations — particularly transfer points between multiple lines — can have dozens or even hundreds of entrance points.

### 3.6 Stations with Most Entrances

| Rank | Station | Agency | Entrances |
|-----:|---------|--------|----------:|
| 1 | Paris Saint-Lazare | Paris Métro | 276 |
| 2 | Paris Gare du Nord | Paris Métro | 209 |
| 3 | Paris Est | Paris Métro | 205 |
| 4 | Paris Gare de Lyon | Paris Métro | 164 |
| 5 | Saint-Lazare | Paris Métro | 124 |
| 6 | Châtelet | Paris Métro | 122 |
| 7 | Haussmann Saint-Lazare | Paris Métro | 121 |
| 8 | République | Paris Métro | 121 |
| 9 | Charles de Gaulle - Etoile | Paris Métro | 113 |
| 10 | Havre-Caumartin | Paris Métro | 92 |

---

## 4. Summary of Key Findings

### Dataset Composition

- The dataset spans **10 transit agencies** in **8 cities** across **3 countries** (USA, France, UK)
- **15,525 total entrance records** covering **2,355 unique stations**
- Paris Métro alone accounts for **11,111 records** (71.6% of the total)

### Key Relationships

1. **System size correlates strongly with station count** — larger systems have proportionally more stations (r = 0.99)
2. **Entrance density is a local property** — it depends on urban form (depth, density, regulations) rather than system size
3. **Geographic spread is independent of system size** — small systems can be geographically wide (BART) and large systems can be compact (Paris Métro relative to its size)
4. **No geographic overlap** between agencies — cross-system comparison is purely structural

### Interesting Facts

| Fact | Detail |
|------|--------|
| Largest dataset | Paris Métro (11,111 records) |
| Smallest dataset | BART (132 records) |
| Most stations | Paris Métro (1,193 stations) |
| Fewest stations | BART (50 stations) |
| Highest entrance density | Paris Métro (9.3/station) |
| Lowest entrance density | LA Metro (2.3/station) |
| Widest geographic spread | SFMTA (σ = 0.2955) |
| Most compact network | CTA (σ = 0.0801) |
| Median entrances/station | 4 |
| Max entrances at one station | 276 (Paris Saint-Lazare, Paris Métro) |

---

## 5. Generated Charts

| # | File | Chart Type | Description |
|---|------|------------|-------------|
| 1 | `01_total_entrances.png` | Horizontal bar | Total entrance records per agency, sorted ascending |
| 2 | `02_unique_stations.png` | Horizontal bar | Unique station names per agency |
| 3 | `03_entrances_per_station.png` | Horizontal bar | Average entrances per station |
| 4 | `04_pie_share.png` | Pie | Proportional share of total records by agency |
| 5 | `05_lat_boxplot.png` | Box plot | Latitude distribution per agency, ordered by median |
| 6 | `06_lon_boxplot.png` | Box plot | Longitude distribution per agency, ordered by median |
| 7 | `07_scatter_all.png` | Scatter | All entrances by lat/lon, colored by agency |
| 8 | `08_correlation_heatmap.png` | Heatmap | Correlation matrix of 6 agency-level metrics |
| 9 | `09_hist_entrances_per_station.png` | Histogram | Distribution of entrances per station |
| 10 | `10_geo_spread.png` | Horizontal bar | Geographic spread (σ) per agency |

---

## 6. Methodology

### Data Loading
- Loaded 10 CSV files from `data/entrances/` using pandas
- Handled both indexed (leading unnamed column) and non-indexed CSV formats
- Filtered out non-data files (`bounding.txt`)
- Coerced latitude and longitude to numeric, dropped rows with missing coordinates

### Statistical Measures
- **Geographic Spread (σ)**: Combined standard deviation of coordinates, computed as σ = √(σ_lat² + σ_lon²)
- **Entrance Density**: Total entrances divided by unique station count
- **Correlation Matrix**: Pearson correlation between 6 agency-level metrics

### Tools Used
- **numpy 1.20+** — numerical computations
- **pandas 1.3+** — data loading, grouping, and aggregation
- **matplotlib 3.4+** — chart rendering at 150 DPI
- **seaborn 0.11+** — heatmap and styled box plots

---

*Report generated by `scripts/report_visualization.py`*